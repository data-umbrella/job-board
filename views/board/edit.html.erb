<% content_for :head do %>
  <link rel="stylesheet" href="/simplemde.min.css">
  <script src="/simplemde.min.js"></script>
<% end %>

<!-- Hero section -->
<section class="mt-12">
  <div class="text-center">
    <div class="text-3xl font-bold mb-2">
      Edit this job posting
    </div>
  </div>
</section>

<!-- Job Listings -->
<section class="my-12 w-full lg:w-4/5 mx-auto">
  <form method="POST" action="update" enctype="multipart/form-data">
    <input name="_method" value="patch" type="hidden">
    <%= erb :'shared/job_form', locals: { job: @job } %>
    <div class="flex items-center justify-between">
      <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" type="submit">
        Update job details
      </button>
    </div>

  </form>
</section>

<script>
  // Add date
  const dateEl = document.querySelector('#preview-date')
  const date = moment().format('MMM D');
  dateEl.innerText = date

  // Add position
  const textInputs = Array.from(document.querySelectorAll('input'));
  const textBoxes = Array.from(document.querySelectorAll('textarea'));
  const inputs = textInputs.concat(textBoxes);
  inputs.forEach(input => input.addEventListener('input', updateValue));

  function updateValue(e) {
    const id = e.target.id
    const previewId = id.replace('original', 'preview')
    const el = document.querySelector(`#${previewId}`)
    el.innerHTML = e.target.value;
  }

</script>

<script>
  const textAreas = ['original-description', 'original-resps', 'original-reqs', 'original-background']

  let descBox = new SimpleMDE({
    element: document.getElementById("original-description"),
    hideIcons: ["quote", "image",],
    status: false,
  });

  let previewTimer = setInterval(updateMarkdown, 10000)

  function updateMarkdown() {
    const descOutput = document.querySelector('#preview-description')
    descOutput.innerHTML = descBox.markdown(descBox.value())

  }

</script>


<script>
  const uploadField = document.getElementById("logo-upload");

  uploadField.onchange = function() {
    if(this.files[0].size > 1097152){
       alert("File is too big!");
       this.value = "";
    };
  };

</script>
